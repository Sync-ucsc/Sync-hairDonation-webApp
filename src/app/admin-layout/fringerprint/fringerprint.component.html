<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<div class="mb-7">
    <div class="row align-items-center">
        <div class="col-lg-9 col-xl-8">
            <div class="row align-items-center">
                <div class="col-md-8 my-2 my-md-0">
                    <div class="input-icon">
                        <input type="text" input matInput (keyup)="applyFilter($event)" class="form-control"
                            placeholder="Search...">
                        <span><i class="flaticon2-search-1 text-muted"></i></span>
                    </div>
                </div>

                <div class="col-md-4 my-2 my-md-0">
                    <div class="d-flex align-items-center">
                        <label class="mr-3 mb-0 d-none d-md-block">Status:</label>

                        <mat-select [(ngModel)]="status">
                            <mat-option (click)="dataFilter('sall')" value="sall">All</mat-option>
                            <mat-option (click)="dataFilter('sblock')" value="sblock">Block</mat-option>
                            <mat-option (click)="dataFilter('sunblock')" value="sunblock">Checked</mat-option>
                        </mat-select>

                    </div>
                </div>
            </div>
        </div>

        <div class="col-12" style="padding-top:15px;">
            <div class="checkbox-inline">
                <style>
                    .nav.nav-bold .nav-item .nav-link .nav-text {
                        padding-left: 15px;
                    }

                    .svg-icon svg {
                        height: 3.5rem;
                        width: 3.5rem;
                    }
                </style>
                
                <label class="checkbox">
                    <input type="checkbox" (click)="dataFilter('donor')">

                    <div>
                        <span class="nav-icon"><span class="svg-icon svg-icon-dark">
                                <svg viewBox="0 -23 512 512" xmlns="http://www.w3.org/2000/svg" width="50px"
                                    height="50px">
                                    <g stroke="none" stroke-width="1">

                                        <path
                                            d="m430.015625 318.078125-86.402344 
                                                                                                                56.921875h-117.613281v-30h75c33.136719 0 
                                                                                                                60-26.863281 60-60h-93.675781c-3.648438 
                                                                                                                0-7.164063-1.332031-9.917969-3.75l-7.046875-6.195312c-39.519531-34.777344-99.183594-34.777344-138.734375 
                                                                                                                0l-45.367188
                                                                                                                39.945312h-66.257812v150h336.023438l175.976562-131.808594c-18.425781-25.929687-55.417969-32.613281-81.984375-15.113281zm0 0"
                                            fill="#000000" />
                                        <path opacity="0.3"
                                            d="m316 225c41.351562 0 75-33.648438 75-75 
                                                                                                                0-13.167969-3.457031-26.117188-10.003906-37.457031l-64.996094-112.542969-64.996094 
                                                                                                                112.542969c-6.546875 11.339843-10.003906 24.289062-10.003906 37.457031 
                                                                                                                0 41.351562 33.648438 75 75 75zm0 0"
                                            fill="#000000" />
                                    </g>
                                </svg>
                                <!--end::Svg Icon--></span></span>
                        <span class="nav-text font-size-lg">Donor</span>
                    </div>
                    <span style="margin-top: 12px;"></span>
                </label>
                <label class="checkbox">
                    <input type="checkbox" (click)="dataFilter('patient')">

                    <div>
                        <span class="nav-icon"><span class="svg-icon svg-icon-dark">
                                <!--begin::Svg Icon | path:/themes/metronic/theme/html/demo8/dist/assets/media/svg/icons/General/User.svg--><svg
                                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <polygon points="0 0 24 0 24 24 0 24" />
                                        <path
                                            d="M12,11 C9.790861,11 8,9.209139 8,7 C8,4.790861 9.790861,3 12,3 C14.209139,3 16,4.790861 16,7 C16,9.209139 14.209139,11 12,11 Z"
                                            fill="#000000" fill-rule="nonzero" opacity="0.3" />
                                        <path
                                            d="M3.00065168,20.1992055 C3.38825852,15.4265159 7.26191235,13 11.9833413,13 C16.7712164,13 20.7048837,15.2931929 20.9979143,20.2 C21.0095879,20.3954741 20.9979143,21 20.2466999,21 C16.541124,21 11.0347247,21 3.72750223,21 C3.47671215,21 2.97953825,20.45918 3.00065168,20.1992055 Z"
                                            fill="#000000" fill-rule="nonzero" />
                                    </g>
                                </svg>
                                <!--end::Svg Icon--></span></span>
                        <span class="nav-text font-size-lg">Patient</span>
                    </div>
                    <span style="margin-top: 12px;"></span>
                </label>
            </div>
        </div>
    </div>
</div>


<table mat-table [dataSource]="dataSource" matSort class="table table-hover">

    <!-- Position Column -->
    <ng-container style="width: 40%;" matColumnDef="fingerprint">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Fingerprint </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.Fingerprint}} </mat-cell>
    </ng-container>

    <!-- Name Column -->
    <ng-container matColumnDef="check">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Check </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.check}} </mat-cell>
    </ng-container>

    <ng-container matColumnDef="action">
        <mat-header-cell *matHeaderCellDef style="width: 50vw;"> Action </mat-header-cell>
        <mat-cell *matCellDef="let element">
            <mat-slide-toggle class="primary" [checked]= element.check
                (change)="checkFingerprint(element.Fingerprint,element.check)">
                Allow?
            </mat-slide-toggle>
        </mat-cell>
    </ng-container>

    


    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;" matRipple class="element-row" [cdkDetailRow]="row"
        [cdkDetailRowTpl]="tpl">
    </mat-row>


    <!-- <mat-row *matRowDef="let row; columns: displayedColumns;" matRipple class="element-row" [cdkDetailRow]="row"
                            [cdkDetailRowTpl]="tpl">
                    </mat-row> -->

</table>
<ng-template #tpl let-element>
    <div class="mat-row detail-row" style="overflow: hidden;width: 80%;padding-left: 10%;">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">E-mail</th>
                    <th scope="col">role</th>
                    <th scope="col">Register IP</th>
                    <th scope="col">City</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let user of filterItemsOfType(element.users); let i = index">
                    <th scope="row">{{i+1}}</th>
                    <td>{{user.email}}</td>
                    <td>{{user.userType}}</td>
                    <td>{{user.registerIp}}</td>
                    <td>{{user.location}}</td>
                </tr>        
            </tbody>
        </table>
    </div>
</ng-template>
<mat-paginator [pageSize]="10" [pageSizeOptions]="[10, 25, 100]" showFirstLastButtons>
</mat-paginator>